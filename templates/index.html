<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Turing Machine Simulator</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="container">
        <!-- ONBOARDING: Shown first, before simulator -->
        <div id="onboarding" class="onboarding">
            <div class="lesson-container">
                <div class="lesson-progress">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill"></div>
                    </div>
                    <span class="progress-text">Lesson <span id="lesson-current">1</span> of <span id="lesson-total">8</span></span>
                </div>

                <div class="lesson-content" id="lesson-content">
                    <!-- Lesson content loads here -->
                </div>

                <div class="lesson-nav">
                    <button id="btn-lesson-prev" class="btn-secondary" disabled>Back</button>
                    <button id="btn-lesson-next" class="btn-primary">Next</button>
                    <button id="btn-start-simulator" class="btn-success hidden">Let's Try It!</button>
                </div>
            </div>
        </div>

        <!-- SIMULATOR: Hidden until onboarding complete -->
        <div id="simulator" class="simulator hidden">
            <header>
                <h1>Turing Machine Simulator</h1>
                <button id="btn-review-lessons" class="tutorial-btn">Review Lessons</button>
            </header>

            <main>
                <!-- Tape Section -->
                <section class="tape-section">
                    <h2>The Tape</h2>
                    <div class="tape-input-row">
                        <label>Your number:</label>
                        <input type="text" id="tape-input" placeholder="e.g., 1011">
                        <button id="btn-set-tape" class="btn-small btn-secondary">Change</button>
                    </div>
                    <div class="tape-wrapper">
                        <div class="tape" id="tape">
                            <!-- Tape cells render here -->
                        </div>
                        <div class="head-indicator">HEAD</div>
                    </div>
                    <div class="state-display">
                        <span class="state-emoji" id="state-emoji"></span>
                        <span class="state-label">Mode: <strong id="current-state">-</strong></span>
                        <span class="state-description" id="state-description"></span>
                        <span id="status-badge" class="status-badge"></span>
                    </div>
                </section>

                <!-- NEXT ACTION: What WILL happen (shown BEFORE the action) -->
                <section class="next-action-section">
                    <h2>Next Action</h2>
                    <div class="next-action-box" id="next-action-box">
                        <div class="next-action-situation">
                            <span>I'm in <strong id="next-state">SCAN</strong> mode and I see: <strong id="next-symbol">1</strong></span>
                        </div>
                        <div class="next-action-will-do">
                            <p id="next-action-text">Keep the 1, move RIGHT, stay in SCAN</p>
                        </div>
                        <div class="next-action-why">
                            <p id="next-action-why">I'm still looking for the end of the number.</p>
                        </div>
                    </div>
                    <div class="goal-display" id="goal-display">
                        <!-- Goal info shows here -->
                    </div>
                </section>

                <!-- Controls -->
                <div class="controls">
                    <button id="btn-step" class="btn-primary">Do This Step</button>
                    <button id="btn-run" class="btn-success">Run All</button>
                    <button id="btn-pause" class="btn-warning" disabled>Pause</button>
                    <button id="btn-reset" class="btn-danger">Start Over</button>
                    <div class="speed-control">
                        <label>Speed:</label>
                        <input type="range" id="speed-slider" min="1" max="100" value="50">
                    </div>
                </div>

                <!-- Rules Section -->
                <section class="rules-section">
                    <div class="rules-header">
                        <h2>The Rules</h2>
                    </div>
                    <div class="rules-groups">
                        <div class="rules-group" id="rules-scan">
                            <h3><span class="state-emoji-small">üîç</span> SCAN MODE</h3>
                            <div class="rules-list" id="rules-list-scan"></div>
                        </div>
                        <div class="rules-group" id="rules-add">
                            <h3><span class="state-emoji-small">‚ûï</span> ADD MODE</h3>
                            <div class="rules-list" id="rules-list-add"></div>
                        </div>
                    </div>
                </section>

                <!-- History Log -->
                <section class="history-section">
                    <h2>What Happened</h2>
                    <div class="history-log" id="history-log">
                        <!-- History entries render here -->
                    </div>
                </section>

                <!-- Challenge Mode Button (shows after completing example) -->
                <section class="challenge-prompt hidden" id="challenge-prompt">
                    <div class="success-message">
                        <h2>Great job! You completed the example!</h2>
                        <p>Ready to design your own algorithm?</p>
                        <button id="btn-start-challenge" class="btn-success btn-large">Try a Challenge!</button>
                    </div>
                </section>
            </main>
        </div>

        <!-- CHALLENGE MODE: Hidden until user clicks "Try a Challenge" -->
        <div id="challenge-mode" class="challenge-mode hidden">
            <header>
                <h1>Challenge Mode</h1>
                <button id="btn-back-to-simulator" class="tutorial-btn">Back to Simulator</button>
            </header>

            <main>
                <!-- Challenge Display -->
                <section class="challenge-section">
                    <h2>Your Challenge</h2>
                    <div class="challenge-card" id="challenge-card">
                        <div class="challenge-task" id="challenge-task">
                            <!-- Challenge task loads here -->
                            <p class="loading">Loading challenge...</p>
                        </div>
                        <div class="challenge-examples" id="challenge-examples">
                            <!-- Examples load here -->
                        </div>
                        <button id="btn-new-challenge" class="btn-secondary btn-small">Get Different Challenge</button>
                    </div>
                </section>

                <!-- Student's Plan Input -->
                <section class="plan-section">
                    <h2>Your Algorithm Plan</h2>
                    <p class="plan-instructions">Describe your algorithm in plain English. What states will you use? What should happen when the head sees each symbol?</p>
                    <textarea id="student-plan" placeholder="Example: I'll start in a SCAN state. When I see a 1, I'll switch to ODD state. When I see another 1, I'll switch back to EVEN state. When I reach a blank, if I'm in EVEN state, the answer is YES..."></textarea>
                    <button id="btn-check-plan" class="btn-primary btn-large">Check My Plan</button>
                </section>

                <!-- Feedback Section -->
                <section class="feedback-section hidden" id="feedback-section">
                    <div class="feedback-box" id="feedback-box">
                        <div class="feedback-icon" id="feedback-icon"></div>
                        <p class="feedback-message" id="feedback-message"></p>
                        <p class="feedback-hint" id="feedback-hint"></p>
                    </div>
                    <button id="btn-run-solution" class="btn-success btn-large hidden">Run My Solution!</button>
                </section>

                <!-- Loading Indicator -->
                <div class="loading-overlay hidden" id="loading-overlay">
                    <div class="spinner"></div>
                    <p>AI is thinking...</p>
                </div>
            </main>
        </div>
    </div>

    <script src="/static/script.js"></script>
</body>
</html>
